<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Benchmark</title>
</head>
<body>
<script>

    const tests = {

        rle: {
            originalBase64: "AGFzbQEAAAABCQJgAABgAn9/AAIPAQNlbnYGbWVtb3J5AgACAwMCAAEGPwp/AUGAiAQLfwBBgAgLfwBBgAgLfwBBgAgLfwBBgIgEC38AQYAIC38AQYCIBAt/AEGAgAgLfwBBAAt/AEEBCwemAQsRX193YXNtX2NhbGxfY3RvcnMAAAtjb21wcmVzc1JMRQABDF9fZHNvX2hhbmRsZQMBCl9fZGF0YV9lbmQDAgtfX3N0YWNrX2xvdwMDDF9fc3RhY2tfaGlnaAMEDV9fZ2xvYmFsX2Jhc2UDBQtfX2hlYXBfYmFzZQMGCl9faGVhcF9lbmQDBw1fX21lbW9yeV9iYXNlAwgMX190YWJsZV9iYXNlAwkK/gECAgAL+AEBCH8gAC0AACECAkACQCAALQABIgMNAEExIQQgAiEDQQAhAAwBCyAAQQFqIQQgAyEDQQAhACACIQJBASEFA0AgBSEFIAAhACAEIQQCQAJAIANB/wFxIAIiA0H/AXFHDQAgBUEBaiEFIAMhAiAAIQAMAQsgASAAaiICIAM6AAAgAkEBaiAFQTBqOgAAQQEhBSAELQAAIQIgAEECaiEACyAEQQFqIgMhBCADLQAAIgYhAyAAIgchACACIgghAiAFIgkhBSAGDQALIAlBMGohBCAIIQMgByEACyABIABqIgAgAzoAACAAQQJqQQA6AAAgAEEBaiAEOgAACw==",
            instrumentedBase64: "AGFzbQEAAAABEANgAABgAn9/AGAEf39/fwACDwEDZW52Bm1lbW9yeQIABAMEAwABAgY/Cn8BQYCIBAt/AEGACAt/AEGACAt/AEGACAt/AEGAiAQLfwBBgAgLfwBBgIgIC38AQYCADAt/AEEAC38AQQELB8QBDBFfX3dhc21fY2FsbF9jdG9ycwAAC2NvbXByZXNzUkxFAAEMX19kc29faGFuZGxlAwEKX19kYXRhX2VuZAMCC19fc3RhY2tfbG93AwMMX19zdGFja19oaWdoAwQNX19nbG9iYWxfYmFzZQMFC19faGVhcF9iYXNlAwYKX19oZWFwX2VuZAMHDV9fbWVtb3J5X2Jhc2UDCAxfX3RhYmxlX2Jhc2UDCRt0YWludF9zaWduYXR1cmVfY29tcHJlc3NSTEUAAgqwBgMCAAsMACAAQX8gAUEAEAILnQYVAX8BfwF/AX8BfwF/AX8BfwF/AX8BfwF/AX8BfwF/AX8BfwF/AX8BfwF/IAAgARoiFC0AACAULQCAgAQhBSEEAkACQCAAIAEaIhQtAAEgFC0AgYAEIQciBiAHGg0AQTFBACEJIQggBCAFIQchBkEAQQAhASEADAELIAAgAUEBQQAhFCEVIBRyIRQgFWogFCEJIQggBiAHIQchBkEAQQAhASEAIAQgBSEFIQRBAUEAIQshCgNAIAogCyELIQogACABIQEhACAIIAkhCSEIAkACQCAGIAdB/wFBACEUIRUgFHIhFCAVcSAUIAQgBSEHIgYgB0H/AUEAIRQhFSAUciEUIBVxIBQhFCEVIBRyIRQgFUcgFBoNACAKIAtBAUEAIRQhFSAUciEUIBVqIBQhCyEKIAYgByEFIQQgACABIQEhAAwBCyACIAMgACABIRQhFSAUciEUIBVqIBQhBSIEIAUgBiAHIRQhFRoiFiAVOgAAIBYgFDoAgIAEIAQgBUEBQQAhFCEVIBRyIRQgFWogFCAKIAtBMEEAIRQhFSAUciEUIBVqIBQhFCEVGiIWIBU6AAAgFiAUOgCAgARBAUEAIQshCiAIIAkaIhQtAAAgFC0AgIAEIQUhBCAAIAFBAkEAIRQhFSAUciEUIBVqIBQhASEACyAIIAlBAUEAIRQhFSAUciEUIBVqIBQhByIGIAchCSEIIAYgBxoiFC0AACAULQCAgAQhDSIMIA0hByEGIAAgASEPIg4gDyEBIQAgBCAFIREiECARIQUhBCAKIAshEyISIBMhCyEKIAwgDRoNAAsgEiATQTBBACEUIRUgFHIhFCAVaiAUIQkhCCAQIBEhByEGIA4gDyEBIQALIAIgAyAAIAEhFCEVIBRyIRQgFWogFCEBIgAgASAGIAchFCEVGiIWIBU6AAAgFiAUOgCAgAQgACABQQJBACEUIRUgFHIhFCAVaiAUQQBBACEUIRUaIhYgFToAACAWIBQ6AICABCAAIAFBAUEAIRQhFSAUciEUIBVqIBQgCCAJIRQhFRoiFiAVOgAAIBYgFDoAgIAECw==",
            entryFunction: "compressRLE",
            inputString: "ABABBACBCC".repeat(2000),
            initialMemory: 2,
        },
        lz77: {
            originalBase64: "AGFzbQEAAAABCwJgAABgA39/fwF/Ag8BA2VudgZtZW1vcnkCAAIDAwIAAQY/Cn8BQYCIBAt/AEGACAt/AEGACAt/AEGACAt/AEGAiAQLfwBBgAgLfwBBgIgEC38AQYCACAt/AEEAC38AQQELB6gBCxFfX3dhc21fY2FsbF9jdG9ycwAADWx6NzdfY29tcHJlc3MAAQxfX2Rzb19oYW5kbGUDAQpfX2RhdGFfZW5kAwILX19zdGFja19sb3cDAwxfX3N0YWNrX2hpZ2gDBA1fX2dsb2JhbF9iYXNlAwULX19oZWFwX2Jhc2UDBgpfX2hlYXBfZW5kAwcNX19tZW1vcnlfYmFzZQMIDF9fdGFibGVfYmFzZQMJCqsDAgIAC6UDAQ5/AkAgAQ0AQQAPC0EAIQNBACEEA0AgAyEFIAAgBCIGaiIHLQAAIQMCQAJAIAYNAEEAIQhBACEJIAMhCgwBC0EAIAEgBmsiBCAEIAFLGyELIAZBf2oiBEE/IARBP0kbQQFqIQxBACENQQEhDiADIQ9BACEEQQAhAwNAIAMhCSAEIQogDyEIIA4hECAHIA0iDmohD0EAIQMCQANAAkAgCyADIgNHDQAgCyENDAILAkAgDyADakF/ai0AACAHIANqLQAARg0AIAMhDQwCCyADQQFqIgQhA0EQIQ0gBEEQRw0ACwsgCSEDIAohBCAIIQ8CQCANIg0gCkwNAAJAIA0gBmoiDyABSQ0AIBAhAyANIQRBACEPDAELIBAhAyANIQQgACAPai0AACEPCyAOQX9qIQ0gEEEBaiEOIA8iCiEPIAQiCSEEIAMiCCEDIAghCCAJIQkgCiEKIBAgDEcNAAsLIAIgBWoiAyAIOgAAIANBAmogCjoAACADQQFqIAkiBDoAACAFQQNqIg0hAyAGIARqQQFqIgchBCANIQ0gByABSQ0ACyANCw==",
            instrumentedBase64: "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",
            entryFunction: "lz77_compress",
            inputString: "ABABBACBCC".repeat(2000),
            initialMemory: 2,
        },
        huffman_encoding: {
            originalBase64: "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",
            instrumentedBase64: "AGFzbQEAAAABtQEXYAAAYAR/f39/AX9gAn9/AGABfwF/YAF/AGAGf39/f39/AGADf39/AX9gBH9/f38AYAV/f39/fwBgCH9/f39/f39/An9/YAR/f39/AGAEf39/fwBgBH9/f38AYAJ/fwJ/f2ACf38Cf39gBH9/f38AYAJ/fwBgAn9/An9/YAx/f39/f39/f39/f38AYAZ/f39/f38Cf39gCH9/f39/f39/AGAKf39/f39/f39/fwBgBH9/f38AAg8BA2VudgZtZW1vcnkCAAQDHh0AAQICAgMDAgQDBQYHCAIJCgsMDQ4PEBESExQVFgZdEH8BQYCIBAt/AEGACAt/AEGACAt/AEGACAt/AEGAiAQLfwBBgAgLfwBBgIgIC38AQYCADAt/AEEAC38AQQELfwFBAAt/AUEAC38BQQALfwFBAAt/AUEAC38BQQALB/YGKxFfX3dhc21fY2FsbF9jdG9ycwAAB25ld05vZGUAAQ1jcmVhdGVNaW5IZWFwAAIPc3dhcE1pbkhlYXBOb2RlAAMKbWluSGVhcGlmeQAECWlzU2l6ZU9uZQAFCmV4dHJhY3RNaW4ABg1pbnNlcnRNaW5IZWFwAAcMYnVpbGRNaW5IZWFwAAgGaXNMZWFmAAkVY3JlYXRlQW5kQnVpbGRNaW5IZWFwAAoQYnVpbGRIdWZmbWFuVHJlZQALCnByaW50Q29kZXMADAxIdWZmbWFuQ29kZXMADQljYWxjRnJlcXMADgxfX2Rzb19oYW5kbGUDAQpfX2RhdGFfZW5kAwILX19zdGFja19sb3cDAwxfX3N0YWNrX2hpZ2gDBA1fX2dsb2JhbF9iYXNlAwULX19oZWFwX2Jhc2UDBgpfX2hlYXBfZW5kAwcNX19tZW1vcnlfYmFzZQMIDF9fdGFibGVfYmFzZQMJEXRhaW50X3Jlc3VsdF8xNV8wAwsRdGFpbnRfcmVzdWx0XzE5XzADDBF0YWludF9yZXN1bHRfMjBfMAMNEXRhaW50X3Jlc3VsdF8yM18wAw4RdGFpbnRfcmVzdWx0XzI1XzADDyV0YWludF9zaWduYXR1cmVfY3JlYXRlQW5kQnVpbGRNaW5IZWFwABgZdGFpbnRfc2lnbmF0dXJlX2NhbGNGcmVxcwAcHHRhaW50X3NpZ25hdHVyZV9idWlsZE1pbkhlYXAAFhl0YWlu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",
            entryFunction: "calcFreqs",
            inputString: "ABABBACBCC".repeat(2000),
            initialMemory: 2,
        }
    };

    const shadowOffset = 70536;
    const pageSize = 65536;
    const recordIterations = 100_000;
    const warmupIterations = recordIterations / 100;

    async function benchMark(taint, test, func, inputOffset = 0) {
        try {

            const results = [];

            const wasmBinary = await WebAssembly.compile(base64ToUint8Array(taint ? test.instrumentedBase64 : test.originalBase64));
            const allocatedPages = test.initialMemory * (taint ? 2 : 1);
            const memory = new WebAssembly.Memory({ initial: allocatedPages});

            const inputArray = new TextEncoder().encode(test.inputString);
            const inputLength = inputArray.length + 1;
            const outputOffset = Math.ceil(test.initialMemory / 2) * (pageSize / 2);

            const full = new Uint8Array(memory.buffer, 0, memory.buffer.byteLength);
            const input = new Uint8Array(memory.buffer, inputOffset, inputLength);
            const output = new Uint8Array(memory.buffer, outputOffset, (inputLength * 2) + 1);

            for (let i = 0; i < recordIterations + warmupIterations; i++) {

                const wasmModule = await WebAssembly.instantiate(wasmBinary, { env: { memory } });

                full.fill(0);
                input.set(inputArray);
                output.fill(0);

                if (taint) {
                    const shadowInput = new Uint8Array(memory.buffer, shadowOffset + inputOffset, inputLength);
                    const shadowOutput = new Uint8Array(memory.buffer, inputOffset + outputOffset + shadowOffset, (inputLength * 2) + 1);
                    shadowInput.fill(1);
                    shadowOutput.fill(0);
                }

                const start = performance.now();

                func(wasmModule.exports[test.entryFunction], inputOffset, inputLength, outputOffset);

                //warm up
                if (i >= warmupIterations) {
                    results.push(performance.now() - start);
                }
            }

            const mean = results.reduce((a, b) => a + b, 0) / results.length;
            const type = taint ? "instrumented" : "original";
            console.log(type + " : " + mean.toFixed(5) + " ms");

        } catch (error) {
            console.log(error);
        }
    }

    function base64ToUint8Array(base64) {
        const binaryString = atob(base64);
        const len = binaryString.length;
        const bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binaryString.charCodeAt(i);
        }
        return bytes;
    }

    async function run() {

        // console.log("test: rle");
        // await benchMark(false, tests.rle, (func, inputOffset, inputLength, outputOffset) => func(inputOffset, outputOffset));
        // await benchMark(true, tests.rle, (func, inputOffset, inputLength, outputOffset) => func(inputOffset, outputOffset));
        //
        // console.log("test: lz77");
        // await benchMark(false, tests.lz77, (func, inputOffset, inputLength, outputOffset) => func(inputOffset, inputLength, outputOffset));
        // await benchMark(true, tests.lz77, (func, inputOffset, inputLength, outputOffset) => func(inputOffset, inputLength, outputOffset));

        console.log("test: huffman_encoding");
        await benchMark(false, tests.huffman_encoding, (func, inputOffset, inputLength, outputOffset) => func(inputOffset, outputOffset));
        await benchMark(true, tests.huffman_encoding, (func, inputOffset, inputLength, outputOffset) => func(inputOffset, outputOffset));

    }

    run();

</script>
</body>
</html>